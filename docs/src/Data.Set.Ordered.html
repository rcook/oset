<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Data.Set.Ordered
Description : Provides an insertion-order-preserving set
Copyright   : (C) Richard Cook, 2019
Licence     : MIT
Maintainer  : rcook@rcook.org
Stability   : stable
Portability : portable

This module provides 'OSet', an insertion-order-preserving set, with
type class instances for 'Foldable', 'Semigroup', 'Monoid' and 'Data' as
well as a 'map' function.

This is intended to be API-compatible with &lt;http://hackage.haskell.org/package/ordered-containers-0.1.1/docs/Data-Set-Ordered.html OSet&gt;
in &lt;http://hackage.haskell.org/package/ordered-containers-0.1.1 unordered-containers&gt;
but with a few extra type class instances.

Here's the quick-start guide to using this package:

&gt; module Main (main) where
&gt;
&gt; import           Data.Set.Ordered ((|&gt;), (|&lt;))
&gt; import qualified Data.Set.Ordered as OSet
&gt;
&gt; main :: IO ()
&gt; main = do
&gt;     -- Create from list
&gt;     let s0 = OSet.fromList [1 :: Int, 2, 3, 4, 4, 3, 2, 1, -1, -2, -3]
&gt;     print s0 -- outputs: &quot;fromList [1,2,3,4,-1,-2,-3]&quot;
&gt;
&gt;     -- Append
&gt;     let s1 = s0 |&gt; 4
&gt;     print s1 -- outputs: &quot;fromList [1,2,3,4,-1,-2,-3]&quot;
&gt;
&gt;     -- Prepend
&gt;     let s2 = 4 |&lt; s0
&gt;     print s2 -- outputs: &quot;fromList [4,1,2,3,-1,-2,-3]&quot;
&gt;
&gt;     -- Semigroup
&gt;     let s3 = s0 &lt;&gt; OSet.fromList [10, 10, 20, 20, 30, 30]
&gt;     print s3 -- outputs: &quot;fromList [1,2,3,4,-1,-2,-3,10,20,30]&quot;
&gt;
&gt;     -- Map (but note that OSet is not a functor)
&gt;     let s4 = OSet.map (\x -&gt; x * x) s3
&gt;     print s4 -- outputs: &quot;fromList [1,4,9,16,100,400,900]&quot;
&gt;
&gt;     -- Filter
&gt;     let s5 = OSet.filter (&gt;= 100) s4
&gt;     print s5 -- outputs: &quot;fromList [100,400,900]&quot;

There are cases where the developer's natural instinct would be to
convert the 'OSet' instance to a list using 'toList' from 'Foldable'.
While this is possible, it will often be more efficient to use 'toSeq'
and operate on the sequence that way. You can even use view patterns to
pattern-match on the resulting sequence:

&gt; {-# LANGUAGE ViewPatterns #-}
&gt;
&gt; module Main (main) where
&gt;
&gt; import           Data.Sequence (ViewL(..), viewl)
&gt; import           Data.Set.Ordered (OSet)
&gt; import qualified Data.Set.Ordered as OSet
&gt;
&gt; showFromLeft :: Show a =&gt; OSet a -&gt; String
&gt; showFromLeft o = go (OSet.toSeq o)
&gt;     where
&gt;         go (viewl -&gt; EmptyL) = &quot;&quot;
&gt;         go (viewl -&gt; h :&lt; t) = show h ++ go t
&gt;         go _ = error &quot;Should not happen&quot; -- suppress warning about non-exhaustive patterns
&gt;
&gt; main :: IO ()
&gt; main = do
&gt;     let a = OSet.fromList [4 :: Int, 1, 3, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
&gt;     print $ showFromLeft a -- outputs: &quot;4139025678&quot;
-}</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><a name="line-79"></a><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><a name="line-80"></a><span class="hs-pragma">{-# OPTIONS_GHC -Wall -Werror #-}</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Set.Ordered</span><span>
</span><a name="line-83"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#%7C%3C"><span class="hs-operator hs-var">|&lt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Set.Ordered.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-87"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Set.Ordered.html#filter"><span class="hs-identifier hs-var">filter</span></a><span>
</span><a name="line-88"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Set.Ordered.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span>
</span><a name="line-89"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Set.Ordered.html#map"><span class="hs-identifier hs-var">map</span></a><span>
</span><a name="line-90"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Set.Ordered.html#member"><span class="hs-identifier hs-var">member</span></a><span>
</span><a name="line-91"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Set.Ordered.html#notMember"><span class="hs-identifier hs-var">notMember</span></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Set.Ordered.html#singleton"><span class="hs-identifier hs-var">singleton</span></a><span>
</span><a name="line-93"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Set.Ordered.html#toSeq"><span class="hs-identifier hs-var">toSeq</span></a><span>
</span><a name="line-94"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Foldable</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Semigroup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Semigroup</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Sequence</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Seq</span><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Sequence</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Seq</span><span>
</span><a name="line-103"></a><span>                    </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">|&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;|</span><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">deleteAt</span><span>
</span><a name="line-106"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">elemIndexL</span><span>
</span><a name="line-107"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-108"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">filter</span><span>
</span><a name="line-109"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">singleton</span><span>
</span><a name="line-110"></a><span>                    </span><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-113"></a><span>                    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-114"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">filter</span><span>
</span><a name="line-115"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">insert</span><span>
</span><a name="line-116"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">member</span><span>
</span><a name="line-117"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">singleton</span><span>
</span><a name="line-118"></a><span>                    </span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- | An 'OSet' behaves much like a 'Set' but remembers the order in</span><span>
</span><a name="line-122"></a><span class="hs-comment">-- which the elements were originally inserted.</span><span>
</span><a name="line-123"></a><span class="hs-keyword">data</span><span> </span><a name="OSet"><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier">OSet</span></a></a><span> </span><a name="local-6989586621679028404"><a href="#local-6989586621679028404"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="OSet"><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier">OSet</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679028404"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Seq</span><span> </span><a href="#local-6989586621679028404"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679032289"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679032289"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-126"></a><span>    </span><a name="local-8214565720323790326"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679032290"><a href="#local-6989586621679032290"><span class="hs-identifier">xsSeq</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679032290"><span class="hs-identifier hs-var">xsSeq</span></a><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-129"></a><span>    </span><a name="local-8214565720323789006"><span class="hs-identifier">foldMap</span></a><span> </span><a name="local-6989586621679032285"><a href="#local-6989586621679032285"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679032286"><a href="#local-6989586621679032286"><span class="hs-identifier">xsSeq</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><a href="#local-6989586621679032285"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679032286"><span class="hs-identifier hs-var">xsSeq</span></a><span>
</span><a name="line-130"></a><span>    </span><a name="local-6989586621679032287"><a href="#local-6989586621679032287"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a name="local-8214565720323788996"><span class="hs-identifier">elem</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><a name="local-6989586621679032288"><a href="#local-6989586621679032288"><span class="hs-identifier">xsSet</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032287"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679032288"><span class="hs-identifier hs-var">xsSet</span></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032284"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Semigroup</span><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679032284"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-133"></a><span>    </span><span class="hs-special">(</span><a name="local-3458764513820541482"><span class="hs-operator">&lt;&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032283"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679032283"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-136"></a><span>    </span><a name="local-3458764513820541483"><span class="hs-identifier">mempty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Set.Ordered.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-comment">-- | \(O(log(N))\). Append an element to the end of set if the set does not</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- already contain the element. The element is ignored if it is already in the</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- set.</span><span>
</span><a name="line-141"></a><span class="hs-special">(</span><span class="hs-operator">|&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679034129"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-142"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679034129"><span class="hs-identifier hs-type">a</span></a><span>   </span><span class="hs-comment">-- ^ set</span><span>
</span><a name="line-143"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679034129"><span class="hs-identifier hs-type">a</span></a><span>        </span><span class="hs-comment">-- ^ element</span><span>
</span><a name="line-144"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679034129"><span class="hs-identifier hs-type">a</span></a><span>   </span><span class="hs-comment">-- ^ set</span><span>
</span><a name="line-145"></a><a name="local-6989586621679034130"><a href="#local-6989586621679034130"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><a name="local-6989586621679034131"><a href="#local-6989586621679034131"><span class="hs-identifier">xsSet</span></a></a><span> </span><a name="local-6989586621679034132"><a href="#local-6989586621679034132"><span class="hs-identifier">xsSeq</span></a></a><span class="hs-special">)</span><span> </span><a name="%7C%3E"><a href="Data.Set.Ordered.html#%7C%3E"><span class="hs-operator">|&gt;</span></a></a><span> </span><a name="local-6989586621679034133"><a href="#local-6989586621679034133"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-146"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679034133"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="Data.Set.Ordered.html#member"><span class="hs-identifier hs-var">member</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679034130"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679034130"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-147"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.insert</span><span> </span><a href="#local-6989586621679034133"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679034131"><span class="hs-identifier hs-var">xsSet</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034132"><span class="hs-identifier hs-var">xsSeq</span></a><span> </span><span class="hs-operator hs-var">Seq.|&gt;</span><span> </span><a href="#local-6989586621679034133"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">5</span><span> </span><a href="Data.Set.Ordered.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">-- | \(O(log(N))\) if the element is not in the set, \(O(N)\) if the element is</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- already in the set. Prepend an element to the head of the set if the set does</span><span>
</span><a name="line-152"></a><span class="hs-comment">-- not already contain the element. The element is moved to the head of the</span><span>
</span><a name="line-153"></a><span class="hs-comment">-- sequence if the element is already present in the set.</span><span>
</span><a name="line-154"></a><span class="hs-special">(</span><span class="hs-operator">|&lt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679034128"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-155"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679034128"><span class="hs-identifier hs-type">a</span></a><span>        </span><span class="hs-comment">-- ^ element</span><span>
</span><a name="line-156"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679034128"><span class="hs-identifier hs-type">a</span></a><span>   </span><span class="hs-comment">-- ^ set</span><span>
</span><a name="line-157"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679034128"><span class="hs-identifier hs-type">a</span></a><span>   </span><span class="hs-comment">-- ^ set</span><span>
</span><a name="line-158"></a><a name="local-6989586621679034134"><a href="#local-6989586621679034134"><span class="hs-identifier">x</span></a></a><span> </span><a name="%7C%3C"><a href="Data.Set.Ordered.html#%7C%3C"><span class="hs-operator">|&lt;</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><a name="local-6989586621679034135"><a href="#local-6989586621679034135"><span class="hs-identifier">xsSet</span></a></a><span> </span><a name="local-6989586621679034136"><a href="#local-6989586621679034136"><span class="hs-identifier">xsSeq</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-159"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679034134"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">Set.member</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679034135"><span class="hs-identifier hs-var">xsSet</span></a><span>
</span><a name="line-160"></a><span>        </span><span class="hs-keyword">then</span><span>
</span><a name="line-161"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Seq.elemIndexL</span><span> </span><a href="#local-6989586621679034134"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679034136"><span class="hs-identifier hs-var">xsSeq</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-162"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.insert</span><span> </span><a href="#local-6989586621679034134"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679034135"><span class="hs-identifier hs-var">xsSet</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034134"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">Seq.&lt;|</span><span> </span><a href="#local-6989586621679034136"><span class="hs-identifier hs-var">xsSeq</span></a><span class="hs-special">)</span><span>
</span><a name="line-163"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679034178"><a href="#local-6989586621679034178"><span class="hs-identifier">idx</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><a href="#local-6989586621679034135"><span class="hs-identifier hs-var">xsSet</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034134"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">Seq.&lt;|</span><span> </span><span class="hs-identifier hs-var">Seq.deleteAt</span><span> </span><a href="#local-6989586621679034178"><span class="hs-identifier hs-var">idx</span></a><span> </span><a href="#local-6989586621679034136"><span class="hs-identifier hs-var">xsSeq</span></a><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.insert</span><span> </span><a href="#local-6989586621679034134"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679034135"><span class="hs-identifier hs-var">xsSet</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034134"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">Seq.&lt;|</span><span> </span><a href="#local-6989586621679034136"><span class="hs-identifier hs-var">xsSeq</span></a><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><a href="Data.Set.Ordered.html#%7C%3C"><span class="hs-operator hs-var">|&lt;</span></a><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">-- | \(O(N log(N))\). Create a set from a finite list of elements. If an element</span><span>
</span><a name="line-168"></a><span class="hs-comment">-- occurs multiple times in the original list, only the first occurrence is</span><span>
</span><a name="line-169"></a><span class="hs-comment">-- retained in the resulting set. The function 'toList', \(O(N)\), in 'Foldable'</span><span>
</span><a name="line-170"></a><span class="hs-comment">-- can be used to return a list of the elements in the original insert order</span><span>
</span><a name="line-171"></a><span class="hs-comment">-- with duplicates removed.</span><span>
</span><a name="line-172"></a><span class="hs-identifier">fromList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679034127"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-173"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679034127"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>      </span><span class="hs-comment">-- ^ elements</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679034127"><span class="hs-identifier hs-type">a</span></a><span>   </span><span class="hs-comment">-- ^ set</span><span>
</span><a name="line-175"></a><a name="fromList"><a href="Data.Set.Ordered.html#fromList"><span class="hs-identifier">fromList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span class="hs-special">)</span><span> </span><a href="Data.Set.Ordered.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">-- | \(O(1)\). The empty set.</span><span>
</span><a name="line-178"></a><span class="hs-identifier">empty</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-179"></a><span>    </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679034126"><span class="hs-identifier hs-type">a</span></a><span>      </span><span class="hs-comment">-- ^ set</span><span>
</span><a name="line-180"></a><a name="empty"><a href="Data.Set.Ordered.html#empty"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><span class="hs-identifier hs-var">Set.empty</span><span> </span><span class="hs-identifier hs-var">Seq.empty</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-comment">-- | \(O(1)\). A singleton set containing the given element.</span><span>
</span><a name="line-183"></a><span class="hs-identifier">singleton</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-184"></a><span>    </span><a href="#local-6989586621679034125"><span class="hs-identifier hs-type">a</span></a><span>           </span><span class="hs-comment">-- ^ element</span><span>
</span><a name="line-185"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679034125"><span class="hs-identifier hs-type">a</span></a><span>   </span><span class="hs-comment">-- ^ set</span><span>
</span><a name="line-186"></a><a name="singleton"><a href="Data.Set.Ordered.html#singleton"><span class="hs-identifier">singleton</span></a></a><span> </span><a name="local-6989586621679034179"><a href="#local-6989586621679034179"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.singleton</span><span> </span><a href="#local-6989586621679034179"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Seq.singleton</span><span> </span><a href="#local-6989586621679034179"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-comment">-- | \(O(log(N))\). Determine if the element is in the set.</span><span>
</span><a name="line-189"></a><span class="hs-identifier">member</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679034124"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-190"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679034124"><span class="hs-identifier hs-type">a</span></a><span>        </span><span class="hs-comment">-- ^ element</span><span>
</span><a name="line-191"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679034124"><span class="hs-identifier hs-type">a</span></a><span>   </span><span class="hs-comment">-- ^ set</span><span>
</span><a name="line-192"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>     </span><span class="hs-comment">-- ^ 'True' if element is in set, 'False' otherwise</span><span>
</span><a name="line-193"></a><a name="member"><a href="Data.Set.Ordered.html#member"><span class="hs-identifier">member</span></a></a><span> </span><a name="local-6989586621679034180"><a href="#local-6989586621679034180"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><a name="local-6989586621679034181"><a href="#local-6989586621679034181"><span class="hs-identifier">xsSet</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679034180"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">Set.member</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679034181"><span class="hs-identifier hs-var">xsSet</span></a><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-comment">-- | \(O(log(N))\). Determine if the element is not in the set.</span><span>
</span><a name="line-196"></a><span class="hs-identifier">notMember</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679034123"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-197"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679034123"><span class="hs-identifier hs-type">a</span></a><span>        </span><span class="hs-comment">-- ^ element</span><span>
</span><a name="line-198"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679034123"><span class="hs-identifier hs-type">a</span></a><span>   </span><span class="hs-comment">-- ^ set</span><span>
</span><a name="line-199"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>     </span><span class="hs-comment">-- ^ 'True' if element is not in set, 'False' otherwise</span><span>
</span><a name="line-200"></a><a name="notMember"><a href="Data.Set.Ordered.html#notMember"><span class="hs-identifier">notMember</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Set.Ordered.html#member"><span class="hs-identifier hs-var">member</span></a><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-comment">-- | \(O(N)\). Filter a set by returning a set whose elements satisfy the</span><span>
</span><a name="line-203"></a><span class="hs-comment">-- predicate.</span><span>
</span><a name="line-204"></a><span class="hs-identifier">filter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032294"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ predicate</span><span>
</span><a name="line-205"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679032294"><span class="hs-identifier hs-type">a</span></a><span>       </span><span class="hs-comment">-- ^ set</span><span>
</span><a name="line-206"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679032294"><span class="hs-identifier hs-type">a</span></a><span>       </span><span class="hs-comment">-- ^ set</span><span>
</span><a name="line-207"></a><a name="filter"><a href="Data.Set.Ordered.html#filter"><span class="hs-identifier">filter</span></a></a><span> </span><a name="local-6989586621679034182"><a href="#local-6989586621679034182"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><a name="local-6989586621679034183"><a href="#local-6989586621679034183"><span class="hs-identifier">xsSet</span></a></a><span> </span><a name="local-6989586621679034184"><a href="#local-6989586621679034184"><span class="hs-identifier">xsSeq</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.filter</span><span> </span><a href="#local-6989586621679034182"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679034183"><span class="hs-identifier hs-var">xsSet</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Seq.filter</span><span> </span><a href="#local-6989586621679034182"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679034184"><span class="hs-identifier hs-var">xsSeq</span></a><span class="hs-special">)</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">-- | \(O(N log(N))\). Return the set obtained by applying a function to each</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- element of this set. Note that the resulting set may be smaller than the</span><span>
</span><a name="line-211"></a><span class="hs-comment">-- original. Along with the 'Ord' constraint, this means that 'OSet' cannot</span><span>
</span><a name="line-212"></a><span class="hs-comment">-- provide a lawful 'Functor' instance.</span><span>
</span><a name="line-213"></a><span class="hs-identifier">map</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679032292"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-214"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032293"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032292"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679032293"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-216"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679032292"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-217"></a><a name="map"><a href="Data.Set.Ordered.html#map"><span class="hs-identifier">map</span></a></a><span> </span><a name="local-6989586621679034185"><a href="#local-6989586621679034185"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679034186"><a href="#local-6989586621679034186"><span class="hs-identifier">xsSeq</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span class="hs-special">)</span><span> </span><a href="Data.Set.Ordered.html#empty"><span class="hs-identifier hs-var">empty</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679034185"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679034186"><span class="hs-identifier hs-var">xsSeq</span></a><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-comment">-- | \(O(1)\). Return ordered sequence of elements in set. For obtaining</span><span>
</span><a name="line-220"></a><span class="hs-comment">-- a useful 'Functor' this is recommended over 'toList' due to its</span><span>
</span><a name="line-221"></a><span class="hs-comment">-- constant-time performance. Similarly, if you want to pattern-match on</span><span>
</span><a name="line-222"></a><span class="hs-comment">-- the 'OSet', obtain the sequence and use view patterns instead of</span><span>
</span><a name="line-223"></a><span class="hs-comment">-- converting to a list.</span><span>
</span><a name="line-224"></a><span class="hs-identifier">toSeq</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-type">OSet</span></a><span> </span><a href="#local-6989586621679032291"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Seq</span><span> </span><a href="#local-6989586621679032291"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-225"></a><a name="toSeq"><a href="Data.Set.Ordered.html#toSeq"><span class="hs-identifier">toSeq</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Set.Ordered.html#OSet"><span class="hs-identifier hs-var">OSet</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679034201"><a href="#local-6989586621679034201"><span class="hs-identifier">xsSeq</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679034201"><span class="hs-identifier hs-var">xsSeq</span></a><span>
</span><a name="line-226"></a></pre></body></html>